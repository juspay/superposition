# Code generated by smithy-python-codegen DO NOT EDIT.

from dataclasses import dataclass
from typing import Any, Callable, TypeAlias, Union

from smithy_core.aio.endpoints import StaticEndpointResolver
from smithy_core.aio.interfaces import EndpointResolver as _EndpointResolver
from smithy_core.interceptors import Interceptor
from smithy_core.interfaces import URI
from smithy_core.interfaces.retries import RetryStrategy
from smithy_core.retries import SimpleRetryStrategy
from smithy_http.aio.aiohttp import AIOHTTPClient
from smithy_http.aio.interfaces import HTTPClient
from smithy_http.aio.interfaces.auth import HTTPAuthScheme
from smithy_http.interfaces import HTTPRequestConfiguration

from .auth import HTTPAuthSchemeResolver
from .models import (
    AddMembersToGroupInput,
    AddMembersToGroupOutput,
    ApplicableVariantsInput,
    ApplicableVariantsOutput,
    BulkOperationInput,
    BulkOperationOutput,
    ConcludeExperimentInput,
    ConcludeExperimentOutput,
    CreateContextInput,
    CreateContextOutput,
    CreateDefaultConfigInput,
    CreateDefaultConfigOutput,
    CreateDimensionInput,
    CreateDimensionOutput,
    CreateExperimentGroupInput,
    CreateExperimentGroupOutput,
    CreateExperimentInput,
    CreateExperimentOutput,
    CreateFunctionInput,
    CreateFunctionOutput,
    CreateOrganisationInput,
    CreateOrganisationOutput,
    CreateTypeTemplatesInput,
    CreateTypeTemplatesOutput,
    CreateWebhookInput,
    CreateWebhookOutput,
    CreateWorkspaceInput,
    CreateWorkspaceOutput,
    DeleteContextInput,
    DeleteContextOutput,
    DeleteDefaultConfigInput,
    DeleteDefaultConfigOutput,
    DeleteDimensionInput,
    DeleteDimensionOutput,
    DeleteExperimentGroupInput,
    DeleteExperimentGroupOutput,
    DeleteFunctionInput,
    DeleteFunctionOutput,
    DeleteTypeTemplatesInput,
    DeleteTypeTemplatesOutput,
    DiscardExperimentInput,
    DiscardExperimentOutput,
    GetConfigFastInput,
    GetConfigFastOutput,
    GetConfigInput,
    GetConfigOutput,
    GetContextFromConditionInput,
    GetContextFromConditionOutput,
    GetContextInput,
    GetContextOutput,
    GetDimensionInput,
    GetDimensionOutput,
    GetExperimentGroupInput,
    GetExperimentGroupOutput,
    GetExperimentInput,
    GetExperimentOutput,
    GetFunctionInput,
    GetFunctionOutput,
    GetOrganisationInput,
    GetOrganisationOutput,
    GetResolvedConfigInput,
    GetResolvedConfigOutput,
    GetTypeTemplatesListInput,
    GetTypeTemplatesListOutput,
    GetWebhookInput,
    GetWebhookOutput,
    ListAuditLogsInput,
    ListAuditLogsOutput,
    ListContextsInput,
    ListContextsOutput,
    ListDefaultConfigsInput,
    ListDefaultConfigsOutput,
    ListDimensionsInput,
    ListDimensionsOutput,
    ListExperimentGroupsInput,
    ListExperimentGroupsOutput,
    ListExperimentInput,
    ListExperimentOutput,
    ListFunctionInput,
    ListFunctionOutput,
    ListOrganisationInput,
    ListOrganisationOutput,
    ListVersionsInput,
    ListVersionsOutput,
    ListWebhookInput,
    ListWebhookOutput,
    ListWorkspaceInput,
    ListWorkspaceOutput,
    MigrateWorkspaceSchemaInput,
    MigrateWorkspaceSchemaOutput,
    MoveContextInput,
    MoveContextOutput,
    PauseExperimentInput,
    PauseExperimentOutput,
    PublishInput,
    PublishOutput,
    RampExperimentInput,
    RampExperimentOutput,
    RemoveMembersFromGroupInput,
    RemoveMembersFromGroupOutput,
    ResumeExperimentInput,
    ResumeExperimentOutput,
    TestInput,
    TestOutput,
    UpdateDefaultConfigInput,
    UpdateDefaultConfigOutput,
    UpdateDimensionInput,
    UpdateDimensionOutput,
    UpdateExperimentGroupInput,
    UpdateExperimentGroupOutput,
    UpdateFunctionInput,
    UpdateFunctionOutput,
    UpdateOrganisationInput,
    UpdateOrganisationOutput,
    UpdateOverrideInput,
    UpdateOverrideOutput,
    UpdateOverridesExperimentInput,
    UpdateOverridesExperimentOutput,
    UpdateTypeTemplatesInput,
    UpdateTypeTemplatesOutput,
    UpdateWebhookInput,
    UpdateWebhookOutput,
    UpdateWorkspaceInput,
    UpdateWorkspaceOutput,
    WeightRecomputeInput,
    WeightRecomputeOutput,
)


_ServiceInterceptor = Union[Interceptor[AddMembersToGroupInput, AddMembersToGroupOutput, Any, Any], Interceptor[ApplicableVariantsInput, ApplicableVariantsOutput, Any, Any], Interceptor[BulkOperationInput, BulkOperationOutput, Any, Any], Interceptor[ConcludeExperimentInput, ConcludeExperimentOutput, Any, Any], Interceptor[CreateContextInput, CreateContextOutput, Any, Any], Interceptor[CreateDefaultConfigInput, CreateDefaultConfigOutput, Any, Any], Interceptor[CreateDimensionInput, CreateDimensionOutput, Any, Any], Interceptor[CreateExperimentInput, CreateExperimentOutput, Any, Any], Interceptor[CreateExperimentGroupInput, CreateExperimentGroupOutput, Any, Any], Interceptor[CreateFunctionInput, CreateFunctionOutput, Any, Any], Interceptor[CreateOrganisationInput, CreateOrganisationOutput, Any, Any], Interceptor[CreateTypeTemplatesInput, CreateTypeTemplatesOutput, Any, Any], Interceptor[CreateWebhookInput, CreateWebhookOutput, Any, Any], Interceptor[CreateWorkspaceInput, CreateWorkspaceOutput, Any, Any], Interceptor[DeleteContextInput, DeleteContextOutput, Any, Any], Interceptor[DeleteDefaultConfigInput, DeleteDefaultConfigOutput, Any, Any], Interceptor[DeleteDimensionInput, DeleteDimensionOutput, Any, Any], Interceptor[DeleteExperimentGroupInput, DeleteExperimentGroupOutput, Any, Any], Interceptor[DeleteFunctionInput, DeleteFunctionOutput, Any, Any], Interceptor[DeleteTypeTemplatesInput, DeleteTypeTemplatesOutput, Any, Any], Interceptor[DiscardExperimentInput, DiscardExperimentOutput, Any, Any], Interceptor[GetConfigInput, GetConfigOutput, Any, Any], Interceptor[GetConfigFastInput, GetConfigFastOutput, Any, Any], Interceptor[GetContextInput, GetContextOutput, Any, Any], Interceptor[GetContextFromConditionInput, GetContextFromConditionOutput, Any, Any], Interceptor[GetDimensionInput, GetDimensionOutput, Any, Any], Interceptor[GetExperimentInput, GetExperimentOutput, Any, Any], Interceptor[GetExperimentGroupInput, GetExperimentGroupOutput, Any, Any], Interceptor[GetFunctionInput, GetFunctionOutput, Any, Any], Interceptor[GetOrganisationInput, GetOrganisationOutput, Any, Any], Interceptor[GetResolvedConfigInput, GetResolvedConfigOutput, Any, Any], Interceptor[GetTypeTemplatesListInput, GetTypeTemplatesListOutput, Any, Any], Interceptor[GetWebhookInput, GetWebhookOutput, Any, Any], Interceptor[ListAuditLogsInput, ListAuditLogsOutput, Any, Any], Interceptor[ListContextsInput, ListContextsOutput, Any, Any], Interceptor[ListDefaultConfigsInput, ListDefaultConfigsOutput, Any, Any], Interceptor[ListDimensionsInput, ListDimensionsOutput, Any, Any], Interceptor[ListExperimentInput, ListExperimentOutput, Any, Any], Interceptor[ListExperimentGroupsInput, ListExperimentGroupsOutput, Any, Any], Interceptor[ListFunctionInput, ListFunctionOutput, Any, Any], Interceptor[ListOrganisationInput, ListOrganisationOutput, Any, Any], Interceptor[ListVersionsInput, ListVersionsOutput, Any, Any], Interceptor[ListWebhookInput, ListWebhookOutput, Any, Any], Interceptor[ListWorkspaceInput, ListWorkspaceOutput, Any, Any], Interceptor[MigrateWorkspaceSchemaInput, MigrateWorkspaceSchemaOutput, Any, Any], Interceptor[MoveContextInput, MoveContextOutput, Any, Any], Interceptor[PauseExperimentInput, PauseExperimentOutput, Any, Any], Interceptor[PublishInput, PublishOutput, Any, Any], Interceptor[RampExperimentInput, RampExperimentOutput, Any, Any], Interceptor[RemoveMembersFromGroupInput, RemoveMembersFromGroupOutput, Any, Any], Interceptor[ResumeExperimentInput, ResumeExperimentOutput, Any, Any], Interceptor[TestInput, TestOutput, Any, Any], Interceptor[UpdateDefaultConfigInput, UpdateDefaultConfigOutput, Any, Any], Interceptor[UpdateDimensionInput, UpdateDimensionOutput, Any, Any], Interceptor[UpdateExperimentGroupInput, UpdateExperimentGroupOutput, Any, Any], Interceptor[UpdateFunctionInput, UpdateFunctionOutput, Any, Any], Interceptor[UpdateOrganisationInput, UpdateOrganisationOutput, Any, Any], Interceptor[UpdateOverrideInput, UpdateOverrideOutput, Any, Any], Interceptor[UpdateOverridesExperimentInput, UpdateOverridesExperimentOutput, Any, Any], Interceptor[UpdateTypeTemplatesInput, UpdateTypeTemplatesOutput, Any, Any], Interceptor[UpdateWebhookInput, UpdateWebhookOutput, Any, Any], Interceptor[UpdateWorkspaceInput, UpdateWorkspaceOutput, Any, Any], Interceptor[WeightRecomputeInput, WeightRecomputeOutput, Any, Any]]
@dataclass(init=False)
class Config:
    """Configuration for Superposition."""

    endpoint_resolver: _EndpointResolver
    endpoint_uri: str | URI | None
    http_auth_scheme_resolver: HTTPAuthSchemeResolver
    http_auth_schemes: dict[str, HTTPAuthScheme[Any, Any, Any, Any]]
    http_client: HTTPClient
    http_request_config: HTTPRequestConfiguration | None
    interceptors: list[_ServiceInterceptor]
    retry_strategy: RetryStrategy

    def __init__(
        self,
        *,
        endpoint_resolver: _EndpointResolver | None = None,
        endpoint_uri: str | URI | None = None,
        http_auth_scheme_resolver: HTTPAuthSchemeResolver | None = None,
        http_auth_schemes: dict[str, HTTPAuthScheme[Any, Any, Any, Any]] | None = None,
        http_client: HTTPClient | None = None,
        http_request_config: HTTPRequestConfiguration | None = None,
        interceptors: list[_ServiceInterceptor] | None = None,
        retry_strategy: RetryStrategy | None = None,
    ):
        """Constructor.

        :param endpoint_resolver:
             The endpoint resolver used to resolve the final endpoint per-operation based on
             the configuration.

        :param endpoint_uri:
             A static URI to route requests to.

        :param http_auth_scheme_resolver:
             An http auth scheme resolver that determines the auth scheme for each operation.

        :param http_auth_schemes:
             A map of http auth scheme ids to http auth schemes.

        :param http_client:
             The HTTP client used to make requests.

        :param http_request_config:
             Configuration for individual HTTP requests.

        :param interceptors:
             The list of interceptors, which are hooks that are called during the execution
             of a request.

        :param retry_strategy:
             The retry strategy for issuing retry tokens and computing retry delays.

        """
        self.endpoint_resolver = endpoint_resolver or StaticEndpointResolver()
        self.endpoint_uri = endpoint_uri
        self.http_auth_scheme_resolver = http_auth_scheme_resolver or HTTPAuthSchemeResolver()
        self.http_auth_schemes = http_auth_schemes or {
        }

        self.http_client = http_client or AIOHTTPClient()
        self.http_request_config = http_request_config
        self.interceptors = interceptors or []
        self.retry_strategy = retry_strategy or SimpleRetryStrategy()

    def set_http_auth_scheme(self, scheme: HTTPAuthScheme[Any, Any, Any, Any]) -> None:
        """Sets the implementation of an auth scheme.

        Using this method ensures the correct key is used.

        :param scheme: The auth scheme to add.
        """
        self.http_auth_schemes[scheme.scheme_id] = scheme

#
# A callable that allows customizing the config object on each request.
#
Plugin: TypeAlias = Callable[[Config], None]
