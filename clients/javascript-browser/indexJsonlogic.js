!function(r,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports["indexJsonlogic-Context-AwareConfig"]=e():r["indexJsonlogic-Context-AwareConfig"]=e()}(self,function(){return r={45:function(r,e){"use strict";var t,n;Object.defineProperty(e,"__esModule",{value:!0}),e.ExperimentStatusType=e.VariantType=void 0,(n=e.VariantType||(e.VariantType={})).CONTROL="CONTROL",n.EXPERIMENTAL="EXPERIMENTAL",(t=e.ExperimentStatusType||(e.ExperimentStatusType={})).CREATED="CREATED",t.INPROGRESS="INPROGRESS",t.CONCLUDED="CONCLUDED",t.DISCARDED="DISCARDED"},620:function(r,e){"use strict";var t=this&&this.__spreadArray||function(r,e,t){if(t||2===arguments.length)for(var n,i=0,o=e.length;i<o;i++)!n&&i in e||(n||(n=Array.prototype.slice.call(e,0,i)),n[i]=e[i]);return r.concat(n||Array.prototype.slice.call(e))};Object.defineProperty(e,"__esModule",{value:!0}),e.deepMerge=void 0;var n=function(r){return r===Object(r)&&!Array.isArray(r)};e.deepMerge=function(r){for(var i=[],o=1;o<arguments.length;o++)i[o-1]=arguments[o];if(!i.length)return r;var a=r;if(n(a))for(var u=i.length,s=0;s<u;s+=1){var f=i[s];if(n(f))for(var l in f)f.hasOwnProperty(l)&&(n(f[l])?(a[l]&&n(a[l])||(a[l]={}),(0,e.deepMerge)(a[l],f[l])):Array.isArray(a[l])&&Array.isArray(f[l])?a[l]=t([],f[l],!0):a[l]=f[l])}return a}},678:function(r,e,t){var n,i;n=function(){"use strict";Array.isArray||(Array.isArray=function(r){return"[object Array]"===Object.prototype.toString.call(r)});var r={},e={"==":function(r,e){return r==e},"===":function(r,e){return r===e},"!=":function(r,e){return r!=e},"!==":function(r,e){return r!==e},">":function(r,e){return r>e},">=":function(r,e){return r>=e},"<":function(r,e,t){return void 0===t?r<e:r<e&&e<t},"<=":function(r,e,t){return void 0===t?r<=e:r<=e&&e<=t},"!!":function(e){return r.truthy(e)},"!":function(e){return!r.truthy(e)},"%":function(r,e){return r%e},log:function(r){return console.log(r),r},in:function(r,e){return!(!e||void 0===e.indexOf)&&-1!==e.indexOf(r)},cat:function(){return Array.prototype.join.call(arguments,"")},substr:function(r,e,t){if(t<0){var n=String(r).substr(e);return n.substr(0,n.length+t)}return String(r).substr(e,t)},"+":function(){return Array.prototype.reduce.call(arguments,function(r,e){return parseFloat(r,10)+parseFloat(e,10)},0)},"*":function(){return Array.prototype.reduce.call(arguments,function(r,e){return parseFloat(r,10)*parseFloat(e,10)})},"-":function(r,e){return void 0===e?-r:r-e},"/":function(r,e){return r/e},min:function(){return Math.min.apply(this,arguments)},max:function(){return Math.max.apply(this,arguments)},merge:function(){return Array.prototype.reduce.call(arguments,function(r,e){return r.concat(e)},[])},var:function(r,e){var t=void 0===e?null:e,n=this;if(void 0===r||""===r||null===r)return n;for(var i=String(r).split("."),o=0;o<i.length;o++){if(null==n)return t;if(void 0===(n=n[i[o]]))return t}return n},missing:function(){for(var e=[],t=Array.isArray(arguments[0])?arguments[0]:arguments,n=0;n<t.length;n++){var i=t[n],o=r.apply({var:i},this);null!==o&&""!==o||e.push(i)}return e},missing_some:function(e,t){var n=r.apply({missing:t},this);return t.length-n.length>=e?[]:n}};return r.is_logic=function(r){return"object"==typeof r&&null!==r&&!Array.isArray(r)&&1===Object.keys(r).length},r.truthy=function(r){return!(Array.isArray(r)&&0===r.length||!r)},r.get_operator=function(r){return Object.keys(r)[0]},r.get_values=function(e){return e[r.get_operator(e)]},r.apply=function(t,n){if(Array.isArray(t))return t.map(function(e){return r.apply(e,n)});if(!r.is_logic(t))return t;var i,o,a,u,s,f=r.get_operator(t),l=t[f];if(Array.isArray(l)||(l=[l]),"if"===f||"?:"==f){for(i=0;i<l.length-1;i+=2)if(r.truthy(r.apply(l[i],n)))return r.apply(l[i+1],n);return l.length===i+1?r.apply(l[i],n):null}if("and"===f){for(i=0;i<l.length;i+=1)if(o=r.apply(l[i],n),!r.truthy(o))return o;return o}if("or"===f){for(i=0;i<l.length;i+=1)if(o=r.apply(l[i],n),r.truthy(o))return o;return o}if("filter"===f)return u=r.apply(l[0],n),a=l[1],Array.isArray(u)?u.filter(function(e){return r.truthy(r.apply(a,e))}):[];if("map"===f)return u=r.apply(l[0],n),a=l[1],Array.isArray(u)?u.map(function(e){return r.apply(a,e)}):[];if("reduce"===f)return u=r.apply(l[0],n),a=l[1],s=void 0!==l[2]?l[2]:null,Array.isArray(u)?u.reduce(function(e,t){return r.apply(a,{current:t,accumulator:e})},s):s;if("all"===f){if(u=r.apply(l[0],n),a=l[1],!Array.isArray(u)||!u.length)return!1;for(i=0;i<u.length;i+=1)if(!r.truthy(r.apply(a,u[i])))return!1;return!0}if("none"===f){if(u=r.apply(l[0],n),a=l[1],!Array.isArray(u)||!u.length)return!0;for(i=0;i<u.length;i+=1)if(r.truthy(r.apply(a,u[i])))return!1;return!0}if("some"===f){if(u=r.apply(l[0],n),a=l[1],!Array.isArray(u)||!u.length)return!1;for(i=0;i<u.length;i+=1)if(r.truthy(r.apply(a,u[i])))return!0;return!1}if(l=l.map(function(e){return r.apply(e,n)}),e.hasOwnProperty(f)&&"function"==typeof e[f])return e[f].apply(n,l);if(f.indexOf(".")>0){var p=String(f).split("."),c=e;for(i=0;i<p.length;i++){if(!c.hasOwnProperty(p[i]))throw new Error("Unrecognized operation "+f+" (failed at "+p.slice(0,i+1).join(".")+")");c=c[p[i]]}return c.apply(n,l)}throw new Error("Unrecognized operation "+f)},r.uses_data=function(e){var t=[];if(r.is_logic(e)){var n=r.get_operator(e),i=e[n];Array.isArray(i)||(i=[i]),"var"===n?t.push(i[0]):i.forEach(function(e){t.push.apply(t,r.uses_data(e))})}return function(r){for(var e=[],t=0,n=r.length;t<n;t++)-1===e.indexOf(r[t])&&e.push(r[t]);return e}(t)},r.add_operation=function(r,t){e[r]=t},r.rm_operation=function(r){delete e[r]},r.rule_like=function(e,t){if(t===e)return!0;if("@"===t)return!0;if("number"===t)return"number"==typeof e;if("string"===t)return"string"==typeof e;if("array"===t)return Array.isArray(e)&&!r.is_logic(e);if(r.is_logic(t)){if(r.is_logic(e)){var n=r.get_operator(t),i=r.get_operator(e);if("@"===n||n===i)return r.rule_like(r.get_values(e,!1),r.get_values(t,!1))}return!1}if(Array.isArray(t)){if(Array.isArray(e)){if(t.length!==e.length)return!1;for(var o=0;o<t.length;o+=1)if(!r.rule_like(e[o],t[o]))return!1;return!0}return!1}return!1},r},void 0===(i=n.call(e,t,e,r))||(r.exports=i)},770:function(r,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.matchRegex=e.isJPVersionLesserEqual=e.isJPVersionLesser=e.isJPVersionGreaterEqual=e.isJPVersionGreater=e.isJPVersionEqual=void 0;var t=function(r,e){return r.localeCompare(e,void 0,{numeric:!0,sensitivity:"base"})};e.isJPVersionEqual=function(r,e){return 0===t(r,e)},e.isJPVersionGreater=function(r,e){return t(r,e)>0},e.isJPVersionGreaterEqual=function(r,e){return t(r,e)>=0},e.isJPVersionLesser=function(r,e,n){return void 0===n?t(r,e)<0:t(r,e)<0&&t(e,n)<0},e.isJPVersionLesserEqual=function(r,e,n){return void 0===n?t(r,e)<=0:t(r,e)<=0&&t(e,n)<=0},e.matchRegex=function(r,e,t){return new RegExp(e,t).test(r)}},790:function(r,e,t){"use strict";var n=this&&this.__assign||function(){return n=Object.assign||function(r){for(var e,t=1,n=arguments.length;t<n;t++)for(var i in e=arguments[t])Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=e[i]);return r},n.apply(this,arguments)},i=this&&this.__createBinding||(Object.create?function(r,e,t,n){void 0===n&&(n=t);var i=Object.getOwnPropertyDescriptor(e,t);i&&!("get"in i?!e.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,n,i)}:function(r,e,t,n){void 0===n&&(n=t),r[n]=e[t]}),o=this&&this.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),a=this&&this.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(null!=r)for(var t in r)"default"!==t&&Object.prototype.hasOwnProperty.call(r,t)&&i(e,r,t);return o(e,r),e},u=this&&this.__spreadArray||function(r,e,t){if(t||2===arguments.length)for(var n,i=0,o=e.length;i<o;i++)!n&&i in e||(n||(n=Array.prototype.slice.call(e,0,i)),n[i]=e[i]);return r.concat(n||Array.prototype.slice.call(e))};Object.defineProperty(e,"__esModule",{value:!0}),e.ExperimentReader=e.CacReader=void 0;var s=a(t(678)),f=t(620),l=t(770),p=t(45),c=function(){function r(r){this.contexts=r.contexts,this.overrides=r.overrides,this.defaultConfig=r.default_configs}return r.prototype.evaluateConfig=function(r){for(var e=this,t=[],i=0;i<this.contexts.length;i++)try{s.apply(this.contexts[i].condition,r)&&t.push.apply(t,this.contexts[i].override_with_keys.map(function(r){return e.overrides[r]}))}catch(r){console.error(r)}var o=n({},this.defaultConfig);return f.deepMerge.apply(void 0,u([o],t,!1))},r}();e.CacReader=c,s.add_operation("match",l.matchRegex),s.add_operation("jp_ver_eq",l.isJPVersionEqual),s.add_operation("jp_ver_gt",l.isJPVersionGreater),s.add_operation("jp_ver_ge",l.isJPVersionGreaterEqual),s.add_operation("jp_ver_lt",l.isJPVersionLesser),s.add_operation("jp_ver_le",l.isJPVersionLesserEqual);var y=function(){function r(r){this.experiments=r}return r.prototype.getApplicableVariants=function(r,e){if(!Number.isInteger(e))throw new Error("Invalid toss, valid range: -1 to 100");for(var t=[],n=0,i=this.getSatisfiedExperiments(r);n<i.length;n++){var o=i[n],a=this.decideVariant(o.traffic_percentage,o.variants,e);a&&t.push(a.id)}return t},r.prototype.getSatisfiedExperiments=function(r){return this.experiments.filter(function(e){return 0===Object.keys(e.context).length||s.apply(e.context,r)})},r.prototype.decideVariant=function(r,e,t){if(Number.isInteger(r)&&Number.isInteger(t)){if(t<0)for(var n=0,i=e;n<i.length;n++){var o=i[n];if(o.variant_type==p.VariantType.EXPERIMENTAL)return o}if(!(t>=r*e.length))return e[Math.floor(t/r)]}},r}();e.ExperimentReader=y}},e={},function t(n){var i=e[n];if(void 0!==i)return i.exports;var o=e[n]={exports:{}};return r[n].call(o.exports,o,o.exports,t),o.exports}(790);var r,e});